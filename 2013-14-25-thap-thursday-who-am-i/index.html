<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />

    <title>James Foster</title>
    
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />

    <link href="css/style.css" rel="stylesheet" />
</head>

<body class="impress-not-supported">

<div class="fallback-message">
    <p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
    <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
</div>

<div id="impress">

    <div id="title" class="step slide">
        <h1>Hello</h1>
    </div>

    <div class="step slide">
        <p><br/><br/><br/>My Name Is James</p>
    </div>

    <div class="step slide">
        <p><br/><br/><br/>My Name Is Also James</p>
    </div>

    <div class="step slide list">
        <p>I am:</p>
        <ul>
          <li>A .NET developer</li>
          <li>A git <span class="delay">guru</span></li>
          <li>An ASP Insider</li>
          <li>A gamer</li>
          <li>A tinker<span class="delay">er</span></li>
        </ul>
    </div>

    <div id="side-step" class="step" data-x="1000" data-z="4000" data-rotate-y="20">
    </div>

    <div class="step slide list">
        <p>I like to:</p>
        <ul>
          <li>Learn</li>
          <li>Explore</li>
          <li>Cook</li>
        </ul>
    </div>

    <div class="step map" id="map">
      <div id="map-canvas"></div>
    </div>

    <div class="step map-part part" id="map-home"></div>
    <div class="step map-part part" id="map-lived"></div>
    <div class="step map-part part" id="map-lived2"></div>
    <div class="step map-part part" id="map-golf"></div>
    <div class="step map-part part" id="map-old-work"></div>
    <div class="step map-part part" id="map-old-work-route"></div>
    <div class="step map-part part" id="map-work-route"></div>
    <div class="step map-part part" id="map-travelled1"></div>
    <div class="step map-part part" id="map-travelled2"></div>
    <div class="step map-part part" id="map-travelled3"></div>

    <div class="step slide">
        <p><br/><br/><br/>The End</p>
    </div>
    
    <div class="step img"><img src="img/01.jpg" /></div>
    <div class="step img"><img src="img/02.jpg" /></div>
    <div class="step img"><img src="img/03.jpg" /></div>
    <div class="step img"><img src="img/04.jpg" /></div>
    <div class="step img"><img src="img/05.jpg" /></div>
    <div class="step img"><img src="img/06.jpg" /></div>
    <div class="step img"><img src="img/07.jpg" /></div>
    <div class="step img"><img src="img/08.jpg" /></div>
    <div class="step img"><img src="img/09.jpg" /></div>
    <div class="step img"><img src="img/10.jpg" /></div>
    <div class="step img"><img src="img/11.jpg" /></div>

</div>

<script src="../js/impress.js"></script>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDqJrZJsqFjDov8eh8whZdRUpEUrgjbx9Y&sensor=true"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery.js"></script>
<script>

$(function(){

  var steps = $('div.step');
  
  var z = 0;
  for(var i = 0; i < steps.size(); i++)
  {
    var el = steps.eq(i);
    
    z += i == 0 || el.is('.part') ? 0 : 800;
    
    var data = steps.get(i).dataset;
    
    el.attr({
      'data-x': Number(data.x || 0),
      'data-y': Number(data.y || 0),
      'data-z': Number(data.z || 0) - z,
    });
  }

  impress().init();
});

$('.list').on('impress:stepenter', function(e){
  var list = $("li, .delay", e.target);
  
  var time = 0;
  for(var i = 0; i < list.size(); i++)
  {
    time += i == 0 ? 0 : list.eq(i).is('.delay') ? 3000 : 10000;
    
    (function(el, delay) {
      setTimeout(function(){
        el.css('opacity', '1');
      }, delay);
    })(list.eq(i), time);
  }
})

  var map;
  var home = new google.maps.LatLng(54.624098,-1.590885);
  var oldWork = new google.maps.LatLng(54.624655,-1.64252);
  var work = new google.maps.LatLng(54.579984,-1.235651);
  var lived = [
    home,
    new google.maps.LatLng(54.630521,-1.5739),
    new google.maps.LatLng(54.632914,-1.559439),
    new google.maps.LatLng(54.62632,-1.579794),
    new google.maps.LatLng(54.612933,-1.570197)
  ];
  var lived2 = lived.concat([
    new google.maps.LatLng(54.662731,-1.549233)
  ]);
  var golf = [
    new google.maps.LatLng(54.638293,-1.574703),
    new google.maps.LatLng(54.644036,-1.573845)
  ]
  
  var travelled1 = [
    new google.maps.LatLng(57.505496,-1.796265),
    new google.maps.LatLng(55.861441,-4.265442),
    new google.maps.LatLng(55.956888,-3.186035),
    new google.maps.LatLng(54.584797,-5.932617),
    new google.maps.LatLng(54.971308,-1.604004),
    new google.maps.LatLng(54.756331,-1.582031),
    new google.maps.LatLng(51.51558,-0.131836),
    new google.maps.LatLng(48.821333,2.351074),
    new google.maps.LatLng(39.563353,2.658691),
    new google.maps.LatLng(41.343825,2.15332),
    new google.maps.LatLng(50.050085,14.436035),
    new google.maps.LatLng(50.064192,19.951172),
    new google.maps.LatLng(50.03454,19.180927),
    new google.maps.LatLng(50.03454,19.180927),
    new google.maps.LatLng(43.201172,27.89978),
    new google.maps.LatLng(41.877741,12.502441),
    new google.maps.LatLng(56.944974,24.11499)
  ];
  
  var travelled2 = travelled1.concat([
    new google.maps.LatLng(34.370645,132.473145),
    new google.maps.LatLng(34.692509,135.501938),
    new google.maps.LatLng(35.003003,135.769043),
    new google.maps.LatLng(35.675147,139.713135),
    new google.maps.LatLng(22.325306,114.169235)
  ]);
  var travelled3 = travelled2.concat([
    new google.maps.LatLng(47.614496,-122.283325)
  ]);
  
  var markers = [];

  function clearMarkers() {
    for(var i in markers) {
      markers[i].setMap(null);
    }
    markers = [];
    
    if(directionsDisplay) {
      directionsDisplay.setMap(null);
    }
  }

  function loadMarkers(locations, clear, display) {
    var bounds = new google.maps.LatLngBounds();

    var time = 0;

    clear = clear || clear === undefined;
    display = display || display === undefined;

    if(clear)
    {
      clearMarkers();
    }

    for(var i in locations)
    {
      bounds.extend(locations[i]);

      if(!display) continue;
      var existing = markers.filter(function(m){return m.position == locations[i]});
      if(existing.length) continue;

      time += i == 0 ? 400 : 200;
      (function(location, delay) {
        setTimeout(function(){
          var marker = new google.maps.Marker ({
            position: location,
            map: map,
            animation: google.maps.Animation.DROP
          });

          markers.push(marker);
        }, delay);
      })(locations[i], time);
    }

    // bounds = fixDateLine(bounds)

    map.fitBounds(bounds);
  }

  function fixDateLine(bounds) {
    var sw = bounds.getSouthWest();
    var ne = bounds.getNorthEast();
    var n = ne.lat();
    var e = ne.lng();
    var s = sw.lat();
    var w = sw.lng();
    
    if(w > e)
    {
      bounds = new google.maps.LatLngBounds();
      
      bounds.extend(new google.maps.LatLng(n, e-179));
      bounds.extend(new google.maps.LatLng(s, w-179));
    }
    
    return bounds;
  }
  
  var directionsService = new google.maps.DirectionsService();
  var directionsDisplay;
  
  function calcRoute(start, stop) {

    if(directionsDisplay) {
      directionsDisplay.setMap(null);
    }
    directionsDisplay = new google.maps.DirectionsRenderer();
    directionsDisplay.setMap(map);
    
  
    var request = {
      origin: start,
      destination: stop,
      travelMode: google.maps.TravelMode.DRIVING,
      provideRouteAlternatives: true
    };
    
    directionsService.route(request, function(result, status) {
      if (status == google.maps.DirectionsStatus.OK) {
        directionsDisplay.setDirections(result);
      }
    });
  }

  $(function(){
    var mapOptions = {
      center: home,
      zoom: 18,
      maxZoom: 18,
      mapTypeId: google.maps.MapTypeId.HYBRID,
      disableDefaultUI: true
    };

    map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
  });
  
  $('#map-home').on('impress:stepenter', function(){ loadMarkers([home]); });
  $('#map-lived').on('impress:stepenter', function(){ loadMarkers(lived, false); });  
  $('#map-lived2').on('impress:stepenter', function(){ loadMarkers(lived2, false); });
  $('#map-golf').on('impress:stepenter', function(){ loadMarkers(golf, true, false); });
  $('#map-old-work').on('impress:stepenter', function(){ loadMarkers([oldWork]); });
  $('#map-old-work-route').on('impress:stepenter', function(){ calcRoute(home, oldWork); });
  $('#map-work-route').on('impress:stepenter', function(){ calcRoute(home, work); });
  $('#map-travelled1').on('impress:stepenter', function(){ loadMarkers(travelled1); });
  $('#map-travelled2').on('impress:stepenter', function(){ loadMarkers(travelled2, false); });
  $('#map-travelled3').on('impress:stepenter', function(){ loadMarkers(travelled3, false); });
  
</script>
</body>
</html>